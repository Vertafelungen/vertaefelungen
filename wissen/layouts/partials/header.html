<!--
File: wissen/layouts/partials/header.html
Version: 2026-01-18  (Europe/Berlin)
Purpose: Site header aligned to main site (image brand left, centered main nav, actions right)
Notes:
- Header main navigation must only include: Shop, FAQ, Produkte/Products, Lookbook.
- "Über uns" is a footer item and must not appear in the header.
- Logo asset served from brand/logo-vl.png via relURL (works under /wissen/).
- No inline styles; styling via site.css.
-->

<header class="site-header">
  <div class="container site-header__inner">
    <a class="brand" href="{{ .Site.Home.RelPermalink }}" aria-label="Vertäfelungen &amp; Lambris">
      <span class="brand__mark">
        <img
          class="brand__logo-img"
          src="{{ "brand/logo-vl.png" | relURL }}"
          alt="Vertäfelungen &amp; Lambris"
          width="260"
          height="52"
          loading="eager"
          decoding="async"
        >
      </span>
      <span class="sr-only">Vertäfelungen &amp; Lambris</span>
    </a>

    <div class="site-header__nav" role="navigation" aria-label="{{ i18n "header_nav_label" }}">
      <input
        class="nav-toggle"
        type="checkbox"
        id="nav-toggle"
        aria-label="{{ i18n "header_toggle_label" }}"
        aria-controls="main-nav"
      >
      <label class="nav-toggle__button" for="nav-toggle" aria-label="{{ i18n "header_toggle_label" }}">
        <span class="nav-toggle__icon"></span>
      </label>

      <div class="nav-panel" id="main-nav">
        {{- $allowed := slice "shop" "faq" "produkte" "products" "lookbook" -}}

        <nav class="main-nav" aria-label="{{ i18n "header_nav_label" }}">
          {{- range .Site.Menus.main -}}
            {{- $id := lower (default "" .Identifier) -}}
            {{- $name := lower (default "" .Name) -}}
            {{- $url := lower (default "" .URL) -}}

            {{- $isAllowed := or (in $allowed $id) (in $allowed $name) -}}
            {{- if not $isAllowed -}}
              {{- /* fallback heuristics via URL */ -}}
              {{- if or (in $url "/shop") (in $url "/faq") (in $url "/produkte") (in $url "/products") (in $url "/lookbook") -}}
                {{- $isAllowed = true -}}
              {{- end -}}
            {{- end -}}

            {{- if $isAllowed -}}
              {{- $label := .Name -}}
              {{- with .Identifier -}}
                {{- $label = i18n . -}}
              {{- end -}}
              {{- $isActive := or ($.IsMenuCurrent "main" .) ($.HasMenuCurrent "main" .) -}}
              <a class="main-nav__link{{ if $isActive }} main-nav__link--active{{ end }}" href="{{ .URL }}">{{ $label }}</a>
            {{- end -}}
          {{- end -}}
        </nav>

        <div class="header-actions">
          <div class="lang-switch" aria-label="{{ i18n "language_switch_label" }}">
            {{- range $index, $site := .Sites -}}
              {{- $isActive := eq $site.Language.Lang $.Site.Language.Lang -}}
              <a class="{{ if $isActive }}is-active{{ end }}" href="{{ $site.Home.RelPermalink }}">{{ upper $site.Language.Lang }}</a>{{ if lt (add $index 1) (len $.Sites) }}<span aria-hidden="true">·</span>{{ end }}
            {{- end -}}
          </div>

          {{- $shopUrl := cond (eq .Site.Language.Lang "de") "https://www.vertaefelungen.de/de/" "https://www.vertaefelungen.de/en/" -}}
          <a class="button button--primary" href="{{ $shopUrl }}">{{ i18n "header_shop_label" }}</a>
        </div>
      </div>
    </div>
  </div>
</header>
