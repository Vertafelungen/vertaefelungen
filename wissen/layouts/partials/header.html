<!--
File: wissen/layouts/partials/header.html
Version: 2026-02-14 19:10 Uhr (Europe/Berlin)
Purpose: Site header aligned to main site (image brand left, centered main nav, actions right)
Change:
- Make menu label rendering robust: if Identifier has no i18n translation, fall back to .Name (prevents empty labels / "dot" symptom).
Notes:
- Header main navigation is intentionally deterministic:
  DE: /wissen/de/shop/ /wissen/de/faq/ /wissen/de/produkte/ /wissen/de/lookbook/
  EN: /wissen/en/shop/ /wissen/en/faq/ /wissen/en/products/ /wissen/en/lookbook/
- "Über uns" is a footer item and must not appear in the header.
- No inline styles; styling via site.css.
-->

<header class="site-header">
  <div class="container site-header__inner">
    <a class="brand" href="{{ .Site.Home.RelPermalink }}" aria-label="Vertäfelungen &amp; Lambris">
      <span class="brand__mark">
        <img
          class="brand__logo-img"
          src="{{ "brand/logo-vl.png" | relURL }}"
          alt="Vertäfelungen &amp; Lambris"
          width="260"
          height="52"
          loading="eager"
          decoding="async"
        >
      </span>
      <span class="sr-only">Vertäfelungen &amp; Lambris</span>
    </a>

    <div class="site-header__nav" role="navigation" aria-label="{{ i18n "header_nav_label" }}">
      <div class="nav-panel">
        <nav class="main-nav" aria-label="{{ i18n "header_nav_label" }}" data-testid="primary-nav">
          {{- range .Site.Menus.main -}}
            {{- $label := .Name -}}
            {{- with .Identifier -}}
              {{- $t := i18n . -}}
              {{- if and $t (ne $t .) -}}
                {{- $label = $t -}}
              {{- end -}}
            {{- end -}}

            {{- $href := "" -}}
            {{- if .Page -}}
              {{- $href = .Page.RelPermalink -}}
            {{- else -}}
              {{- $raw := .URL -}}
              {{- if or (hasPrefix $raw "http://") (hasPrefix $raw "https://") -}}
                {{- $href = $raw -}}
              {{- else -}}
                {{- $href = $raw | relLangURL -}}
                {{- if and (not (hasSuffix $href "/")) (not (in $href "?")) (not (in $href "#")) -}}
                  {{- $href = printf "%s/" $href -}}
                {{- end -}}
              {{- end -}}
            {{- end -}}

            {{- $isActive := and (not (hasPrefix $href "http://")) (not (hasPrefix $href "https://")) (hasPrefix $.RelPermalink $href) -}}
            <a class="main-nav__link{{ if $isActive }} main-nav__link--active{{ end }}" href="{{ $href }}">{{ $label }}</a>
          {{- end -}}
        </nav>
      </div>

      <div class="header-actions">
        <div class="lang-switch" aria-label="{{ i18n "language_switch_label" }}">
          {{- range $index, $site := .Sites -}}
            {{- $isActive := eq $site.Language.Lang $.Site.Language.Lang -}}
            <a class="{{ if $isActive }}is-active{{ end }}" href="{{ $site.Home.RelPermalink }}">{{ upper $site.Language.Lang }}</a>{{ if lt (add $index 1) (len $.Sites) }}<span aria-hidden="true">·</span>{{ end }}
          {{- end -}}
        </div>

        <button
          class="nav-toggle__button"
          type="button"
          data-testid="hamburger-button"
          aria-label="{{ i18n "header_toggle_label" }}"
          aria-controls="nav-drawer"
          aria-expanded="false"
        >
          <span class="nav-toggle__icon" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </div>

</header>

{{ partial "nav-drawer.html" . }}
