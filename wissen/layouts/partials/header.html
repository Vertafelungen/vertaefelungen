<!--
File: wissen/layouts/partials/header.html
Version: 2026-01-23 08:20 Uhr (Europe/Berlin)
Purpose: Site header aligned to main site (image brand left, centered main nav, actions right)
Change: Fix duplicate /wissen prefix in header nav URLs by removing hardcoded "/wissen/" from $base.
Notes:
- Header main navigation is intentionally deterministic:
  DE: /wissen/de/shop/ /wissen/de/faq/ /wissen/de/produkte/ /wissen/de/lookbook/
  EN: /wissen/en/shop/ /wissen/en/faq/ /wissen/en/products/ /wissen/en/lookbook/
- "Über uns" is a footer item and must not appear in the header.
- No inline styles; styling via site.css.
-->

<header class="site-header">
  <div class="container site-header__inner">
    <a class="brand" href="{{ .Site.Home.RelPermalink }}" aria-label="Vertäfelungen &amp; Lambris">
      <span class="brand__mark">
        <img
          class="brand__logo-img"
          src="{{ "brand/logo-vl.png" | relURL }}"
          alt="Vertäfelungen &amp; Lambris"
          width="260"
          height="52"
          loading="eager"
          decoding="async"
        >
      </span>
      <span class="sr-only">Vertäfelungen &amp; Lambris</span>
    </a>

    <div class="site-header__nav" role="navigation" aria-label="{{ i18n "header_nav_label" }}">
      <input
        class="nav-toggle"
        type="checkbox"
        id="nav-toggle"
        aria-label="{{ i18n "header_toggle_label" }}"
        aria-controls="main-nav"
      >
      <label class="nav-toggle__button" for="nav-toggle" aria-label="{{ i18n "header_toggle_label" }}">
        <span class="nav-toggle__icon"></span>
      </label>

      <div class="nav-panel" id="main-nav">
        {{- $lang := .Site.Language.Lang -}}

        {{/* IMPORTANT:
            relURL already prefixes the site base path (here: /wissen/).
            Therefore, $base must NOT include "/wissen/" to avoid /wissen/wissen/... */}}
        {{- $base := printf "/%s/" $lang -}}

        {{- $shopPath := "shop/" -}}
        {{- $faqPath := "faq/" -}}
        {{- $productsPath := cond (eq $lang "de") "produkte/" "products/" -}}
        {{- $lookbookPath := "lookbook/" -}}

        {{- $shopUrl := relURL (printf "%s%s" $base $shopPath) -}}
        {{- $faqUrl := relURL (printf "%s%s" $base $faqPath) -}}
        {{- $productsUrl := relURL (printf "%s%s" $base $productsPath) -}}
        {{- $lookbookUrl := relURL (printf "%s%s" $base $lookbookPath) -}}

        <nav class="main-nav" aria-label="{{ i18n "header_nav_label" }}" data-testid="primary-nav">
          <a class="main-nav__link{{ if hasPrefix .RelPermalink $shopUrl }} main-nav__link--active{{ end }}" href="{{ $shopUrl }}">Shop</a>
          <a class="main-nav__link{{ if hasPrefix .RelPermalink $faqUrl }} main-nav__link--active{{ end }}" href="{{ $faqUrl }}">FAQ</a>

          {{- if eq $lang "de" -}}
            <a class="main-nav__link{{ if hasPrefix .RelPermalink $productsUrl }} main-nav__link--active{{ end }}" href="{{ $productsUrl }}">Produkte</a>
          {{- else -}}
            <a class="main-nav__link{{ if hasPrefix .RelPermalink $productsUrl }} main-nav__link--active{{ end }}" href="{{ $productsUrl }}">Products</a>
          {{- end -}}

          <a class="main-nav__link{{ if hasPrefix .RelPermalink $lookbookUrl }} main-nav__link--active{{ end }}" href="{{ $lookbookUrl }}">Lookbook</a>
        </nav>

        <div class="header-actions">
          <div class="lang-switch" aria-label="{{ i18n "language_switch_label" }}">
            {{- range $index, $site := .Sites -}}
              {{- $isActive := eq $site.Language.Lang $.Site.Language.Lang -}}
              <a class="{{ if $isActive }}is-active{{ end }}" href="{{ $site.Home.RelPermalink }}">{{ upper $site.Language.Lang }}</a>{{ if lt (add $index 1) (len $.Sites) }}<span aria-hidden="true">·</span>{{ end }}
            {{- end -}}
          </div>

          {{- $shopCta := cond (eq $lang "de") "https://www.vertaefelungen.de/de/" "https://www.vertaefelungen.de/en/" -}}
          <a class="button button--primary" data-testid="header-cta" href="{{ $shopCta }}">{{ i18n "header_shop_label" }}</a>
        </div>
      </div>
    </div>
  </div>
</header>
