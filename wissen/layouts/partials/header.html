<!--
File: wissen/layouts/partials/header.html
Version: 2026-01-23 08:20 Uhr (Europe/Berlin)
Purpose: Site header aligned to main site (image brand left, centered main nav, actions right)
Change: Fix duplicate /wissen prefix in header nav URLs by removing hardcoded "/wissen/" from $base.
Notes:
- Header main navigation is intentionally deterministic:
  DE: /wissen/de/shop/ /wissen/de/faq/ /wissen/de/produkte/ /wissen/de/lookbook/
  EN: /wissen/en/shop/ /wissen/en/faq/ /wissen/en/products/ /wissen/en/lookbook/
- "Über uns" is a footer item and must not appear in the header.
- No inline styles; styling via site.css.
-->

<header class="site-header">
  <div class="container site-header__inner">
    <a class="brand" href="{{ .Site.Home.RelPermalink }}" aria-label="Vertäfelungen &amp; Lambris">
      <span class="brand__mark">
        <img
          class="brand__logo-img"
          src="{{ "brand/logo-vl.png" | relURL }}"
          alt="Vertäfelungen &amp; Lambris"
          width="260"
          height="52"
          loading="eager"
          decoding="async"
        >
      </span>
      <span class="sr-only">Vertäfelungen &amp; Lambris</span>
    </a>

    <div class="site-header__nav" role="navigation" aria-label="{{ i18n "header_nav_label" }}">
      <div class="nav-panel">
        {{- $lang := .Site.Language.Lang -}}
        {{- $homeBase := .Site.Home.RelPermalink -}}
        {{- $productsPath := cond (eq $lang "de") "produkte/" "products/" -}}

        {{- $shopUrl := printf "%sshop/" $homeBase -}}
        {{- $faqUrl := printf "%sfaq/" $homeBase -}}
        {{- $productsUrl := printf "%s%s" $homeBase $productsPath -}}
        {{- $lookbookUrl := printf "%slookbook/" $homeBase -}}

        <nav class="main-nav" aria-label="{{ i18n "header_nav_label" }}" data-testid="primary-nav">
          <a class="main-nav__link{{ if hasPrefix .RelPermalink $shopUrl }} main-nav__link--active{{ end }}" href="{{ $shopUrl }}">Shop</a>
          <a class="main-nav__link{{ if hasPrefix .RelPermalink $faqUrl }} main-nav__link--active{{ end }}" href="{{ $faqUrl }}">FAQ</a>

          {{- if eq $lang "de" -}}
            <a class="main-nav__link{{ if hasPrefix .RelPermalink $productsUrl }} main-nav__link--active{{ end }}" href="{{ $productsUrl }}">Produkte</a>
          {{- else -}}
            <a class="main-nav__link{{ if hasPrefix .RelPermalink $productsUrl }} main-nav__link--active{{ end }}" href="{{ $productsUrl }}">Products</a>
          {{- end -}}

          <a class="main-nav__link{{ if hasPrefix .RelPermalink $lookbookUrl }} main-nav__link--active{{ end }}" href="{{ $lookbookUrl }}">Lookbook</a>
        </nav>
      </div>

      <div class="header-actions">
        <div class="lang-switch" aria-label="{{ i18n "language_switch_label" }}">
          {{- range $index, $site := .Sites -}}
            {{- $isActive := eq $site.Language.Lang $.Site.Language.Lang -}}
            <a class="{{ if $isActive }}is-active{{ end }}" href="{{ $site.Home.RelPermalink }}">{{ upper $site.Language.Lang }}</a>{{ if lt (add $index 1) (len $.Sites) }}<span aria-hidden="true">·</span>{{ end }}
          {{- end -}}
        </div>

        <button
          class="nav-toggle__button"
          type="button"
          data-testid="hamburger-button"
          aria-label="{{ i18n "header_toggle_label" }}"
          aria-controls="nav-drawer"
          aria-expanded="false"
        >
          <span class="nav-toggle__icon" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </div>

  <div class="nav-drawer" id="nav-drawer" data-testid="nav-drawer" aria-hidden="true">
    <div class="nav-drawer__overlay" data-testid="nav-drawer-overlay"></div>
    <div class="nav-drawer__panel" role="dialog" aria-modal="true" aria-label="{{ i18n "header_nav_label" }}" tabindex="-1">
      <div class="nav-drawer__section" data-testid="drawer-main-links">
        <p class="nav-drawer__title">{{ i18n "header_nav_label" }}</p>
        <ul class="nav-drawer__list">
          {{- range .Site.Menus.main -}}
            {{- $label := .Name -}}
            {{- with .Identifier -}}
              {{- $label = i18n . -}}
            {{- end -}}
            <li><a href="{{ .URL }}">{{ $label }}</a></li>
          {{- end -}}
        </ul>
      </div>

      <div class="nav-drawer__section" data-testid="drawer-footer-links">
        <p class="nav-drawer__title">{{ i18n "drawer_footer_title" }}</p>
        <ul class="nav-drawer__list">
          {{- range .Site.Menus.footer -}}
            {{- $label := .Name -}}
            {{- with .Identifier -}}
              {{- $label = i18n . -}}
            {{- end -}}
            <li><a href="{{ .URL }}">{{ $label }}</a></li>
          {{- end -}}
        </ul>
      </div>
    </div>
  </div>
</header>
