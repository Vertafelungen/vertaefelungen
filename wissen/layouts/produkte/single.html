{{ define "main" }}
<article class="container mx-auto px-4 py-8 product-page">
  <nav class="breadcrumbs" aria-label="{{ i18n "breadcrumbs_label" | default "Breadcrumbs" }}">
    <a href="{{ .Site.Home.RelPermalink }}">{{ i18n "breadcrumbs_home" | default "Start" }}</a>
    {{- range .Ancestors.Reverse -}}
      {{- if not .IsHome -}}
        <span aria-hidden="true">/</span>
        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
      {{- end -}}
    {{- end -}}
    <span aria-hidden="true">/</span>
    <span aria-current="page">{{ .Title }}</span>
  </nav>

  <header class="product-hero mb-6">
    <h1 class="text-3xl font-semibold product-title">{{ .Title }}</h1>
    {{ with .Params.seo.description }}
      <p class="lead product-intro">{{ . }}</p>
    {{ end }}
  </header>

  {{ partial "gallery.html" . }}

  {{- $techItems := slice -}}
  {{- with .Params.produkt.artikelnummer -}}
    {{- $techItems = $techItems | append (dict "label" (i18n "product_sku" | default "Artikelnummer") "value" .) -}}
  {{- end -}}
  {{- with .Params.produkt.preis_basis -}}
    {{- $techItems = $techItems | append (dict "label" (i18n "product_base_price" | default "Basispreis") "value" (printf "%.2f €" .)) -}}
  {{- end -}}
  {{- with .Params.produkt.verfuegbar -}}
    {{- $availability := cond . (i18n "product_available" | default "Verfügbar") (i18n "product_unavailable" | default "Nicht verfügbar") -}}
    {{- $techItems = $techItems | append (dict "label" (i18n "product_status" | default "Status") "value" $availability) -}}
  {{- end -}}
  {{- with .Params.technische_daten -}}
    {{- if reflect.IsMap . -}}
      {{- range $label, $value := . -}}
        {{- $techItems = $techItems | append (dict "label" $label "value" $value) -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}

  {{ if or $techItems .Params.merkmale }}
    <section class="product-specs">
      <h2 class="section-title">{{ i18n "product_specs" | default "Technische Daten" }}</h2>
      {{ if $techItems }}
        <dl class="spec-grid">
          {{ range $techItems }}
            <div>
              <dt>{{ .label }}</dt>
              <dd>{{ .value }}</dd>
            </div>
          {{ end }}
        </dl>
      {{ end }}
      {{ with .Params.merkmale }}
        <ul class="feature-list">
          {{ range . }}
            <li>{{ . }}</li>
          {{ end }}
        </ul>
      {{ end }}
    </section>
  {{ end }}

  <section class="prose max-w-none">
    {{ .Content }}
  </section>

  {{ partial "cta.html" . }}

  {{ partial "product/jsonld.html" (dict "ctx" .) }}
</article>
{{ end }}
