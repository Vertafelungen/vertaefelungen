name: Security Secret Scan

on:
  push: {}
  pull_request: {}
  workflow_dispatch: {}

jobs:
  secret-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Scan for leaked private keys
        run: |
          set -euo pipefail
          if git ls-files -z | xargs -0 rg -n --fixed-strings -e 'BEGIN PRIVATE KEY' -e '"private_key"'; then
            echo "::error::Potential secret material detected in tracked files."
            exit 1
          fi
